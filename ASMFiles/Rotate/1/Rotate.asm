@16384
D=A
D=D+A
@MASKER
M=D

(LOOP)
@R4
D=M
@FINISHED
D;JEQ

@MASKER
D=M
@R3
D=D&M
@ROTATE_BITS
D;JNE

@R3
D=M
M=M+D
@SUBTRACT_COUNTER
0;JMP

(ROTATE_BITS)
@R3
D=M
M=M+1
M=M+D

(SUBTRACT_COUNTER)
@R4
D=M
M=D-1
@LOOP
0;JMP

(FINISHED)
@R3
D=M
@R5
M=D
@LOOP
0;JMP